{"version":3,"sources":["webpack:///./src/views/PlayerPage/PlayerPage.jsx","webpack:///./src/utils/utils.js","webpack:///./src/containers/PlayerLazyLoad/PlayerLazyLoad.jsx","webpack:///./src/components/LazyLoad/LazyLoad.jsx","webpack:///./src/containers/PlayerScrollLoad/PlayerScrollLoad.jsx"],"names":["_react","__webpack_require__","_PlayerLazyLoad","_PlayerScrollLoad","TabPane","_tabs2","default","PlayerPage","swtichPanel","key","console","log","_react2","createElement","className","defaultActiveKey","onChange","this","tab","_PlayerLazyLoad2","_PlayerScrollLoad2","Component","getType","obj","Object","prototype","toString","call","slice","findParent","el","parent","parentNode","indexOf","_reactRedux","_redux","_LazyLoad","_players","_utils","PlayerLazyLoad","connect","state","players","dispatch","bindActionCreators","getPlayers","props","_classCallCheck","_this","_possibleConstructorReturn","__proto__","getPrototypeOf","scrollEl","scrollRef","React","createRef","setState","current","ref","list","map","player","id","_LazyLoad2","height","container","src","picture","alt","name","shirt_num","country","birthday","transfer_fee","_propTypes","_lodash","LazyLoad","visible","onScroll","offset","box","elRef","getBoundingClientRect","clientHeight","top","_","throttle","window","addEventListener","removeEventListener","_props","placeholder","children","style","propTypes","PropTypes","any","object","number","isRequired","defaultProps","before","PlayerSrollLoad","getScrollPlayers","scrollStatus","handleScroll","_this$props","curPlayer","scrollTop","scrollHeight","total","length","curTotal","loadMore","page","size","then","_state","list2","every","p","_toConsumableArray"],"mappings":"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","file":"PlayerPage.41ce5ca709344a47083f.js","sourcesContent":["import React, { Component } from 'react'\nimport { Tabs } from 'antd'\nimport PlayerLazyLoad from '../../containers/PlayerLazyLoad/PlayerLazyLoad'\nimport PlayerScrollLoad from '../../containers/PlayerScrollLoad/PlayerScrollLoad'\nimport './style.scss'\n\nconst TabPane = Tabs.TabPane\n\nclass PlayerPage extends Component {\n  swtichPanel = (key) => {\n    console.log(key)\n  }\n\n  render() {\n    return (\n      <div className=\"player-tabs\">\n        <Tabs defaultActiveKey=\"lazyLoad\" onChange={this.swtichPanel}>\n          <TabPane tab=\"懒加载\" key=\"lazyLoad\"><PlayerLazyLoad /></TabPane>\n          <TabPane tab=\"滚动加载\" key=\"scrollLoad\"><PlayerScrollLoad /></TabPane>\n        </Tabs>\n      </div>\n    )\n  }\n}\n\nexport default PlayerPage\n","export const getType = obj => Object.prototype.toString.call(obj).slice(8, -1)\n\nexport const findParent = (el, className) => {\n  let parent = el.parentNode\n  while (parent && parent.className.indexOf(className) === -1) {\n    parent = parent.parentNode\n  }\n  return parent\n}\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport LazyLoad from '../../components/LazyLoad/LazyLoad'\nimport { getPlayers } from '../../redux/actions/players'\nimport { findParent } from '../../utils/utils.js'\nimport './style.scss'\n\n@connect(\n  state => ({ players: state.players }),\n  dispatch => bindActionCreators({ getPlayers }, dispatch)\n)\nclass PlayerLazyLoad extends Component {\n  state = {\n    scrollEl: null\n  }\n\n  constructor(props) {\n    super(props)\n    this.scrollRef = React.createRef()\n  }\n\n  componentDidMount() {\n    const { getPlayers } = this.props\n    getPlayers()\n    this.setState({\n      scrollEl: findParent(this.scrollRef.current, 'ui-main-content')\n    })\n  }\n\n  render() {\n    const { players } = this.props\n    const { scrollEl } = this.state\n    return (\n      <div ref={this.scrollRef}>\n        {\n          players.list.map(player => (\n            <div key={player.id} className=\"player-info-wrapper\">\n              <div className=\"player-info clearfix\">\n                <div className=\"player-info__img\">\n                  {scrollEl && (\n                  <LazyLoad height={365} container={scrollEl}>\n                    <img src={player.picture} alt=\"\" />\n                  </LazyLoad>\n                  ) }\n                </div>\n                <p className=\"player-info__detail\">{player.name}</p>\n                <p className=\"player-info__detail\">{player.shirt_num}</p>\n                <p className=\"player-info__detail\">{player.country}</p>\n                <p className=\"player-info__detail\">{player.birthday}</p>\n                <p className=\"player-info__detail\">{player.transfer_fee}</p>\n              </div>\n            </div>\n          ))\n        }\n      </div>\n    )\n  }\n}\n\nexport default PlayerLazyLoad\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\n\nclass LazyLoad extends Component {\n  static propTypes = {\n    placeholder: PropTypes.any,\n    container: PropTypes.object,\n    height: PropTypes.number.isRequired,\n    offset: PropTypes.number\n  }\n\n  static defaultProps = {\n    offset: -200\n  }\n\n  state = {\n    visible: false\n  }\n\n  constructor(props) {\n    super(props)\n    this.elRef = React.createRef()\n    this.onScroll = _.throttle(this.onScroll, 200)\n  }\n\n  componentDidMount() {\n    const { container } = this.props\n    this.scrollEl = container || window\n    this.scrollEl.addEventListener('scroll', this.onScroll)\n    this.onScroll()\n  }\n\n  componentWillUnmount() {\n    this.scrollEl.removeEventListener('scroll', this.onScroll)\n  }\n\n  onScroll = () => {\n    const { offset } = this.props\n    const box = this.elRef.current.getBoundingClientRect()\n    if (this.scrollEl.clientHeight > box.top + offset) {\n      this.setState({\n        visible: true\n      })\n    }\n  }\n\n  render() {\n    const { height, placeholder, children } = this.props\n    const { visible } = this.state\n    return (\n      <div style={{ height: `${height}px` }} ref={this.elRef}>\n        { !visible ? placeholder : children }\n      </div>\n    )\n  }\n}\n\nexport default LazyLoad\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport _ from 'lodash';\nimport { getScrollPlayers, getPlayers } from '../../redux/actions/players';\nimport { findParent } from '../../utils/utils.js';\nimport './style.scss';\n\nconst before = 100;\n\n@connect(\n  state => ({ players: state.players }),\n  dispatch => bindActionCreators({ getScrollPlayers, getPlayers }, dispatch)\n)\nclass PlayerSrollLoad extends Component {\n  state = {\n    players: [],\n    scrollStatus: ''\n  };\n\n  constructor(props) {\n    super(props);\n    this.scrollRef = React.createRef();\n    this.handleScroll = _.throttle(this.handleScroll, 200);\n    this.scrollEl = null;\n    this.page = 1\n    this.size = 6\n    this.loadMore = true\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const player = props.players.list2 && props.players.list2[0];\n    if (player && state.players.every(p => p.id !== player.id)) {\n      return {\n        players: [...state.players, ...props.players.list2]\n      };\n    }\n    return null;\n  }\n\n  componentDidMount() {\n    const { getScrollPlayers } = this.props;\n    this.scrollEl = findParent(this.scrollRef.current, 'ui-main-content');\n    this.scrollEl.addEventListener('scroll', this.handleScroll);\n    getScrollPlayers(this.page, this.size);\n    getPlayers()\n  }\n\n  componentWillUnmount() {\n    this.scrollEl.removeEventListener('scroll', this.handleScroll);\n  }\n\n  handleScroll = () => {\n    const { getScrollPlayers, players } = this.props\n    const { players: curPlayer } = this.state\n    const clientHeight = this.scrollEl.clientHeight\n    const scrollTop = this.scrollEl.scrollTop\n    const scrollHeight = this.scrollEl.scrollHeight\n    this.total = players.list.length\n    this.curTotal = curPlayer.length\n    if (this.total === this.curTotal) {\n      this.scrollEl.removeEventListener('scroll', this.handleScroll)\n      this.setState({\n        scrollStatus: '已经到底啦...'\n      })\n      return\n    }\n    if (clientHeight + scrollTop >= scrollHeight - before && this.loadMore) {\n      this.loadMore = false\n      this.setState({\n        scrollStatus: 'loading'\n      })\n      getScrollPlayers(++this.page, this.size).then(() => {\n        this.loadMore = true\n        this.setState({\n          scrollStatus: ''\n        })\n      })\n    }\n  };\n\n  render() {\n    const { players, scrollStatus } = this.state;\n    return (\n      <div ref={this.scrollRef}>\n        {players.map(player => (\n          <div key={player.id} className=\"player-info-wrapper\">\n            <div className=\"player-info clearfix\">\n              <div className=\"player-info__img\">\n                <img src={player.picture} alt=\"\" />\n              </div>\n              <p className=\"player-info__detail\">{player.name}</p>\n              <p className=\"player-info__detail\">{player.shirt_num}</p>\n              <p className=\"player-info__detail\">{player.country}</p>\n              <p className=\"player-info__detail\">{player.birthday}</p>\n              <p className=\"player-info__detail\">{player.transfer_fee}</p>\n            </div>\n          </div>\n        ))}\n        <div className=\"scrollStatus\">{scrollStatus}</div>\n      </div>\n    );\n  }\n}\n\nexport default PlayerSrollLoad;\n"],"sourceRoot":""}