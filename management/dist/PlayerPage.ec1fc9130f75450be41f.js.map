{"version":3,"sources":["webpack:///./src/views/PlayerPage/PlayerPage.jsx","webpack:///./src/utils/utils.js","webpack:///./src/containers/PlayerLazyLoad/PlayerLazyLoad.jsx","webpack:///./src/components/LazyLoad/LazyLoad.jsx","webpack:///./src/containers/PlayerScrollLoad/PlayerScrollLoad.jsx"],"names":["_react","__webpack_require__","TabPane","_tabs2","default","PlayerPage","swtichPanel","key","console","log","Component","_react2","createElement","className","defaultActiveKey","onChange","this","tab","_PlayerLazyLoad2","_PlayerScrollLoad2","getType","obj","Object","prototype","toString","call","slice","findParent","el","parent","parentNode","indexOf","_reactRedux","_redux","_players","_utils","PlayerLazyLoad","connect","state","players","dispatch","bindActionCreators","getPlayers","props","_classCallCheck","_this","_possibleConstructorReturn","__proto__","getPrototypeOf","scrollEl","scrollRef","React","createRef","setState","current","ref","list","map","player","id","_LazyLoad2","height","container","src","picture","alt","name","shirt_num","country","birthday","transfer_fee","LazyLoad","visible","onScroll","offset","box","elRef","getBoundingClientRect","clientHeight","top","_","throttle","window","addEventListener","removeEventListener","_props","placeholder","children","style","propTypes","PropTypes","any","object","number","isRequired","defaultProps","before","PlayerSrollLoad","getScrollPlayers","scrollStatus","handleScroll","_this$props","curPlayer","scrollTop","scrollHeight","total","length","curTotal","loadMore","page","size","then","_state","list2","every","p","_toConsumableArray"],"mappings":"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","file":"PlayerPage.ec1fc9130f75450be41f.js","sourcesContent":["import React, { Component } from 'react'\nimport { Tabs } from 'antd'\nimport PlayerLazyLoad from '../../containers/PlayerLazyLoad/PlayerLazyLoad'\nimport PlayerScrollLoad from '../../containers/PlayerScrollLoad/PlayerScrollLoad'\nimport './style.scss'\n\nconst TabPane = Tabs.TabPane\n\nclass PlayerPage extends Component {\n  swtichPanel = (key) => {\n    console.log(key)\n  }\n\n  render() {\n    return (\n      <div className=\"player-tabs\">\n        <Tabs defaultActiveKey=\"lazyLoad\" onChange={this.swtichPanel}>\n          <TabPane tab=\"懒加载\" key=\"lazyLoad\"><PlayerLazyLoad /></TabPane>\n          <TabPane tab=\"滚动加载\" key=\"scrollLoad\"><PlayerScrollLoad /></TabPane>\n        </Tabs>\n      </div>\n    )\n  }\n}\n\nexport default PlayerPage\n","export const getType = obj => Object.prototype.toString.call(obj).slice(8, -1)\n\nexport const findParent = (el, className) => {\n  let parent = el.parentNode\n  while (parent && parent.className.indexOf(className) === -1) {\n    parent = parent.parentNode\n  }\n  return parent\n}\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport LazyLoad from '../../components/LazyLoad/LazyLoad'\nimport { getPlayers } from '../../redux/actions/players'\nimport { findParent } from '../../utils/utils.js'\nimport './style.scss'\n\n@connect(\n  state => ({ players: state.players }),\n  dispatch => bindActionCreators({ getPlayers }, dispatch)\n)\nclass PlayerLazyLoad extends Component {\n  state = {\n    scrollEl: null\n  }\n\n  constructor(props) {\n    super(props)\n    this.scrollRef = React.createRef()\n  }\n\n  componentDidMount() {\n    const { getPlayers } = this.props\n    getPlayers()\n    this.setState({\n      scrollEl: findParent(this.scrollRef.current, 'ui-main-content')\n    })\n  }\n\n  render() {\n    const { players } = this.props\n    const { scrollEl } = this.state\n    return (\n      <div ref={this.scrollRef}>\n        {\n          players.list.map(player => (\n            <div key={player.id} className=\"player-info-wrapper\">\n              <div className=\"player-info clearfix\">\n                <div className=\"player-info__img\">\n                  {scrollEl && (\n                  <LazyLoad height={365} container={scrollEl}>\n                    <img src={player.picture} alt=\"\" />\n                  </LazyLoad>\n                  ) }\n                </div>\n                <p className=\"player-info__detail\">{player.name}</p>\n                <p className=\"player-info__detail\">{player.shirt_num}</p>\n                <p className=\"player-info__detail\">{player.country}</p>\n                <p className=\"player-info__detail\">{player.birthday}</p>\n                <p className=\"player-info__detail\">{player.transfer_fee}</p>\n              </div>\n            </div>\n          ))\n        }\n      </div>\n    )\n  }\n}\n\nexport default PlayerLazyLoad\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\n\nclass LazyLoad extends Component {\n  static propTypes = {\n    placeholder: PropTypes.any,\n    container: PropTypes.object,\n    height: PropTypes.number.isRequired,\n    offset: PropTypes.number\n  }\n\n  static defaultProps = {\n    offset: -200\n  }\n\n  state = {\n    visible: false\n  }\n\n  constructor(props) {\n    super(props)\n    this.elRef = React.createRef()\n    this.onScroll = _.throttle(this.onScroll, 200)\n  }\n\n  componentDidMount() {\n    const { container } = this.props\n    this.scrollEl = container || window\n    this.scrollEl.addEventListener('scroll', this.onScroll)\n    this.onScroll()\n  }\n\n  componentWillUnmount() {\n    this.scrollEl.removeEventListener('scroll', this.onScroll)\n  }\n\n  onScroll = () => {\n    const { offset } = this.props\n    const box = this.elRef.current.getBoundingClientRect()\n    if (this.scrollEl.clientHeight > box.top + offset) {\n      this.setState({\n        visible: true\n      })\n    }\n  }\n\n  render() {\n    const { height, placeholder, children } = this.props\n    const { visible } = this.state\n    return (\n      <div style={{ height: `${height}px` }} ref={this.elRef}>\n        { !visible ? placeholder : children }\n      </div>\n    )\n  }\n}\n\nexport default LazyLoad\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport _ from 'lodash';\nimport { getScrollPlayers, getPlayers } from '../../redux/actions/players';\nimport { findParent } from '../../utils/utils.js';\nimport './style.scss';\n\nconst before = 100;\n\n@connect(\n  state => ({ players: state.players }),\n  dispatch => bindActionCreators({ getScrollPlayers, getPlayers }, dispatch)\n)\nclass PlayerSrollLoad extends Component {\n  state = {\n    players: [],\n    scrollStatus: ''\n  };\n\n  constructor(props) {\n    super(props);\n    this.scrollRef = React.createRef();\n    this.handleScroll = _.throttle(this.handleScroll, 200);\n    this.scrollEl = null;\n    this.page = 1\n    this.size = 6\n    this.loadMore = true\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const player = props.players.list2 && props.players.list2[0];\n    if (player && state.players.every(p => p.id !== player.id)) {\n      return {\n        players: [...state.players, ...props.players.list2]\n      };\n    }\n    return null;\n  }\n\n  componentDidMount() {\n    const { getScrollPlayers } = this.props;\n    this.scrollEl = findParent(this.scrollRef.current, 'ui-main-content');\n    this.scrollEl.addEventListener('scroll', this.handleScroll);\n    getScrollPlayers(this.page, this.size);\n    getPlayers()\n  }\n\n  componentWillUnmount() {\n    this.scrollEl.removeEventListener('scroll', this.handleScroll);\n  }\n\n  handleScroll = () => {\n    const { getScrollPlayers, players } = this.props\n    const { players: curPlayer } = this.state\n    const clientHeight = this.scrollEl.clientHeight\n    const scrollTop = this.scrollEl.scrollTop\n    const scrollHeight = this.scrollEl.scrollHeight\n    this.total = players.list.length\n    this.curTotal = curPlayer.length\n    if (this.total === this.curTotal) {\n      this.scrollEl.removeEventListener('scroll', this.handleScroll)\n      this.setState({\n        scrollStatus: '已经到底啦...'\n      })\n      return\n    }\n    if (clientHeight + scrollTop >= scrollHeight - before && this.loadMore) {\n      this.loadMore = false\n      this.setState({\n        scrollStatus: 'loading'\n      })\n      getScrollPlayers(++this.page, this.size).then(() => {\n        this.loadMore = true\n        this.setState({\n          scrollStatus: ''\n        })\n      })\n    }\n  };\n\n  render() {\n    const { players, scrollStatus } = this.state;\n    return (\n      <div ref={this.scrollRef}>\n        {players.map(player => (\n          <div key={player.id} className=\"player-info-wrapper\">\n            <div className=\"player-info clearfix\">\n              <div className=\"player-info__img\">\n                <img src={player.picture} alt=\"\" />\n              </div>\n              <p className=\"player-info__detail\">{player.name}</p>\n              <p className=\"player-info__detail\">{player.shirt_num}</p>\n              <p className=\"player-info__detail\">{player.country}</p>\n              <p className=\"player-info__detail\">{player.birthday}</p>\n              <p className=\"player-info__detail\">{player.transfer_fee}</p>\n            </div>\n          </div>\n        ))}\n        <div className=\"scrollStatus\">{scrollStatus}</div>\n      </div>\n    );\n  }\n}\n\nexport default PlayerSrollLoad;\n"],"sourceRoot":""}